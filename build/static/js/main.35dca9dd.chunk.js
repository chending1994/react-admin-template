(this.webpackJsonpreact_admin_guli=this.webpackJsonpreact_admin_guli||[]).push([[0],{357:function(e,t,n){},430:function(e,t,n){},435:function(e,t,n){},436:function(e,t,n){},445:function(e,t,n){},470:function(e,t,n){},577:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(45),s=n.n(c),i=n(19),o=n(20),l=n(22),u=n(21),d=n(116),h=n(43),p=(n(59),n(29)),j=(n(111),n(44)),b=(n(87),n(42)),m=n(26),f=n.n(m),O=(n(97),n(38)),x=n(37),g=n(586),y=n(587),v=n(181),k=n(298),w=n.n(k),C=n(226),S=n.n(C);function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return new Promise((function(a,r){("GET"===n?S.a.get(e,{params:t}):S.a.post(e,t)).then((function(e){a(e.data)})).catch((function(e){O.b.error("\u8bf7\u6c42\u51fa\u9519\u4e86: "+e.message)}))}))}var I="https://api.chending.top";function F(e,t){return N(I+"/login",{username:e,password:t},"POST")}function T(e){return N(I+"/manage/category/list",{parentId:e})}function P(e){return N(I+"/manage/category/info",{categoryId:e})}function _(e,t){return N(I+"/manage/category/add",{categoryName:e,parentId:t},"POST")}function A(e){var t=e.categoryId,n=e.categoryName;return N(I+"/manage/category/update",{categoryId:t,categoryName:n},"POST")}function R(e,t){return N(I+"/manage/product/list",{pageNum:e,pageSize:t})}function M(e){var t=e.pageNum,n=e.pageSize,a=e.searchName,r=e.searchType;return N(I+"/manage/product/search",Object(v.a)({pageNum:t,pageSize:n},r,a))}function L(e,t){return N(I+"/manage/product/updateStatus",{productId:e,status:t},"POST")}function U(e){return N(I+"/manage/img/delete",{name:e},"POST")}function D(e){return N(I+"/manage/product/"+(e._id?"update":"add"),e,"POST")}function E(e){return N(I+"/manage/role/add",{roleName:e},"POST")}function V(e){return N(I+"/manage/role/update",e,"POST")}function W(){return N(I+"/manage/user/list")}function z(e){return N(I+"/manage/user/delete",{userId:e},"POST")}function K(e){return N(I+"/manage/user/"+(e._id?"update":"add"),e,"POST")}function B(e){return new Promise((function(t,n){var a="http://api.map.baidu.com/telematics/v3/weather?location=".concat(e,"&output=json&ak=3p49MVra6urFRGOT9s8UBWr2");w()(a,{},(function(e,n){if(console.log("jsonp()",e,n),e||"success"!==n.status)O.b.error("\u83b7\u53d6\u5929\u6c14\u4fe1\u606f\u5931\u8d25!");else{var a=n.results[0].weather_data[0],r=a.dayPictureUrl,c=a.weather;t({dayPictureUrl:r,weather:c})}}))}))}var J={user:{}},q=n(209),H=n.n(q),Y="user_key",G=function(e){H.a.set(Y,e)},Q=function(){return H.a.get(Y)||{}},X=function(){H.a.remove(Y)},Z=n.p+"static/media/logo.cc99a15a.png",$=(n(357),n(4)),ee=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).onFinish=function(){var t=Object(x.a)(f.a.mark((function t(n){var a,r,c,s;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.username,r=n.password,t.next=3,F(a,r);case 3:0===(c=t.sent).status?(O.b.success("\u767b\u9646\u6210\u529f"),s=c.data,J.user=s,G(s),e.props.history.push("/")):O.b.error(c.msg),console.log("data",c);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onFinishFailed=function(e){console.log("Failed:",e)},e.validatePwd=function(e,t,n){t?t.length<4?n("\u5bc6\u7801\u957f\u5ea6\u4e0d\u80fd\u5c0f\u4e8e4\u4f4d"):t.length>12?n("\u5bc6\u7801\u957f\u5ea6\u4e0d\u80fd\u5927\u4e8e12\u4f4d"):/^[a-zA-Z0-9_]+$/.test(t)?n():n("\u5bc6\u7801\u5fc5\u987b\u662f\u82f1\u6587\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210"):n("\u5bc6\u7801\u5fc5\u987b\u8f93\u5165")},e}return Object(o.a)(n,[{key:"render",value:function(){return Object($.jsxs)("div",{className:"login",children:[Object($.jsxs)("header",{className:"login-header",children:[Object($.jsx)("img",{src:Z,alt:"logo"}),Object($.jsx)("h1",{children:"\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf"})]}),Object($.jsxs)("section",{className:"login-content",children:[Object($.jsx)("h2",{children:"\u7528\u6237\u767b\u9646"}),Object($.jsxs)(j.a,{name:"basic",onFinish:this.onFinish,onFinishFailed:this.onFinishFailed,autoComplete:"off",className:"login-form",children:[Object($.jsx)(j.a.Item,{name:"username",rules:[{required:!0,message:"\u7528\u6237\u540d\u5fc5\u987b\u8f93\u5165"},{min:4,message:"\u7528\u6237\u540d\u81f3\u5c114\u4f4d"},{max:12,message:"\u7528\u6237\u540d\u6700\u591a12\u4f4d"},{pattern:/^[a-zA-Z0-9_]+$/,message:"\u7528\u6237\u540d\u5fc5\u987b\u662f\u82f1\u6587\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210"}],children:Object($.jsx)(b.a,{prefix:Object($.jsx)(g.a,{style:{color:"rgba(0,0,0,.25)"}}),placeholder:"\u7528\u6237\u540d"})}),Object($.jsx)(j.a.Item,{name:"password",rules:[{validator:this.validatePwd}],children:Object($.jsx)(b.a.Password,{prefix:Object($.jsx)(y.a,{style:{color:"rgba(0,0,0,.25)"}}),placeholder:"\u5bc6\u7801"})}),Object($.jsx)(j.a.Item,{children:Object($.jsx)(p.a,{type:"primary",htmlType:"submit",className:"login-form-button",children:"\u767b\u9646"})})]})]})]})}}]),n}(a.Component),te=(n(426),n(138)),ne=(n(428),n(78)),ae=n(588),re=n(589),ce=n(314),se=n(590),ie=n(591),oe=n(592),le=n(593),ue=n(594),de=n(595),he=[{title:"\u9996\u9875",key:"/home",icon:ae.a,isPublic:!0},{title:"\u5546\u54c1",key:"/products",icon:re.a,children:[{title:"\u54c1\u7c7b\u7ba1\u7406",key:"/category",icon:ce.a},{title:"\u5546\u54c1\u7ba1\u7406",key:"/product",icon:se.a}]},{title:"\u7528\u6237\u7ba1\u7406",key:"/user",icon:g.a},{title:"\u89d2\u8272\u7ba1\u7406",key:"/role",icon:ie.a},{title:"\u56fe\u5f62\u56fe\u8868",key:"/charts",icon:oe.a,children:[{title:"\u67f1\u5f62\u56fe",key:"/charts/bar",icon:le.a},{title:"\u6298\u7ebf\u56fe",key:"/charts/line",icon:ue.a},{title:"\u997c\u56fe",key:"/charts/pie",icon:de.a}]}],pe=(n(430),ne.a.SubMenu),je=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).hasAuth=function(e){var t=e.key,n=e.isPublic,a=J.user.role.menus;return!("admin"!==J.user.username&&!n&&-1===a.indexOf(t))||!!e.children&&!!e.children.find((function(e){return-1!==a.indexOf(e.key)}))},e.getMenuNodes=function(t){var n=e.props.location.pathname;return t.reduce((function(t,a){e.hasAuth(a)&&(a.children?(a.children.find((function(e){return 0===n.indexOf(e.key)}))&&(e.openKey=a.key),t.push(Object($.jsx)(pe,{icon:Object($.jsx)(a.icon,{}),title:Object($.jsx)("span",{children:Object($.jsx)("span",{children:a.title})}),children:e.getMenuNodes(a.children)},a.key))):t.push(Object($.jsx)(ne.a.Item,{icon:Object($.jsx)(a.icon,{}),children:Object($.jsx)(d.b,{to:a.key,children:Object($.jsx)("span",{children:a.title})})},a.key)));return t}),[])},e}return Object(o.a)(n,[{key:"componentWillMount",value:function(){this.menuNodes=this.getMenuNodes(he)}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.location.pathname;-1!==e.indexOf("/product")&&(e="/product");var t=this.openKey;return Object($.jsxs)("div",{className:"left-nav",children:[Object($.jsx)(d.b,{to:"/",className:"left-nav-header",children:Object($.jsx)("img",{src:Z,alt:"logo"})}),Object($.jsx)(ne.a,{selectedKeys:[e],defaultOpenKeys:[t],mode:"inline",theme:"dark",children:this.menuNodes})]})}}]),n}(a.Component),be=Object(h.g)(je),me=(n(142),n(67));function fe(e){if(!e)return"";var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}var Oe=n(58),xe=(n(435),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object($.jsx)("button",Object(Oe.a)(Object(Oe.a)({},this.props),{},{className:"link-button"}))}}]),n}(a.Component)),ge=(n(436),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={},e.getTime=function(){e.intervalId=setInterval((function(){var t=fe(Date.now());e.setState({currentTime:t})}),1e3)},e.getTitle=function(){var t,n=e.props.location.pathname;return he.forEach((function(e){if(e.key===n)t=e.title;else if(e.children){var a=e.children.find((function(e){return 0===n.indexOf(e.key)}));a&&(t=a.title)}})),t},e.getWeather=Object(x.a)(f.a.mark((function t(){var n,a,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B("\u5317\u4eac");case 2:n=t.sent,a=n.dayPictureUrl,r=n.weather,e.setState({dayPictureUrl:a,weather:r});case 6:case"end":return t.stop()}}),t)}))),e.logout=function(){me.a.confirm({content:"\u786e\u5b9a\u9000\u51fa\u5417?",onOk:function(){X(),J.user={},e.props.history.replace("/login")}})},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"render",value:function(){var e=J.user.username,t=this.getTitle();return Object($.jsxs)("div",{className:"header",children:[Object($.jsxs)("div",{className:"header-top",children:[Object($.jsxs)("span",{children:["\u6b22\u8fce, ",e]}),Object($.jsx)(xe,{onClick:this.logout,children:"\u9000\u51fa"})]}),Object($.jsxs)("div",{className:"header-bottom",children:[Object($.jsx)("div",{className:"header-bottom-left",children:t}),Object($.jsx)("div",{className:"header-bottom-right"})]})]})}}]),n}(a.Component)),ye=Object(h.g)(ge),ve=(n(437),n(139)),ke=(n(83),n(40)),we=(n(578),n(210)),Ce=(n(579),n(309)),Se=n(313),Ne=n(596),Ie=n(597),Fe=n(598),Te=n(79),Pe=n.n(Te),_e=n(86),Ae=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object($.jsx)("div",{style:{float:"right",width:750,height:400},children:Object($.jsxs)(_e.Chart,{scale:{temperature:{min:0},city:{formatter:function(e){return{London:"\u4f26\u6566",Tokyo:"\u4e1c\u4eac"}[e]}}},padding:[30,20,60,40],autoFit:!0,height:300,data:[{month:"Jan",city:"Tokyo",temperature:7},{month:"Jan",city:"London",temperature:3.9},{month:"Feb",city:"Tokyo",temperature:6.9},{month:"Feb",city:"London",temperature:4.2},{month:"Mar",city:"Tokyo",temperature:9.5},{month:"Mar",city:"London",temperature:5.7},{month:"Apr",city:"Tokyo",temperature:14.5},{month:"Apr",city:"London",temperature:8.5},{month:"May",city:"Tokyo",temperature:18.4},{month:"May",city:"London",temperature:11.9},{month:"Jun",city:"Tokyo",temperature:21.5},{month:"Jun",city:"London",temperature:15.2},{month:"Jul",city:"Tokyo",temperature:25.2},{month:"Jul",city:"London",temperature:17},{month:"Aug",city:"Tokyo",temperature:26.5},{month:"Aug",city:"London",temperature:16.6},{month:"Sep",city:"Tokyo",temperature:23.3},{month:"Sep",city:"London",temperature:14.2},{month:"Oct",city:"Tokyo",temperature:18.3},{month:"Oct",city:"London",temperature:10.3},{month:"Nov",city:"Tokyo",temperature:13.9},{month:"Nov",city:"London",temperature:6.6},{month:"Dec",city:"Tokyo",temperature:9.6},{month:"Dec",city:"London",temperature:4.8}],interactions:["element-active"],children:[Object($.jsx)(_e.Point,{position:"month*temperature",color:"city",shape:"circle"}),Object($.jsx)(_e.Line,{shape:"smooth",position:"month*temperature",color:"city",label:"temperature"}),Object($.jsx)(_e.Tooltip,{shared:!0,showCrosshairs:!0}),Object($.jsx)(_e.Legend,{background:{padding:[5,100,5,36],style:{fill:"#eaeaea",stroke:"#fff"}}})]})})}}]),n}(r.a.Component),Re=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object($.jsx)("div",{style:{width:"100%"},children:Object($.jsxs)(_e.Chart,{height:400,autoFit:!0,data:[{year:"1951 \u5e74",sales:38},{year:"1952 \u5e74",sales:52},{year:"1956 \u5e74",sales:61},{year:"1957 \u5e74",sales:45},{year:"1958 \u5e74",sales:48},{year:"1959 \u5e74",sales:38},{year:"1960 \u5e74",sales:38},{year:"1962 \u5e74",sales:38}],interactions:["active-region"],padding:[30,30,30,50],children:[Object($.jsx)(_e.Interval,{position:"year*sales"}),Object($.jsx)(_e.Tooltip,{shared:!0})]})})}}]),n}(r.a.Component),Me=(n(445),"YYYY/MM/DD"),Le=Ce.a.RangePicker,Ue=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={isVisited:!0},e.handleChange=function(t){return function(){return e.setState({isVisited:t})}},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this.state.isVisited;return Object($.jsxs)("div",{className:"home",children:[Object($.jsxs)(ke.a,{className:"home-card",title:"\u5546\u54c1\u603b\u91cf",extra:Object($.jsx)(Se.a,{style:{color:"rgba(0,0,0,.45)"}}),style:{width:250},headStyle:{color:"rgba(0,0,0,.45)"},children:[Object($.jsx)(we.a,{value:1128163,suffix:"\u4e2a",style:{fontWeight:"bolder"}}),Object($.jsx)(we.a,{value:15,valueStyle:{fontSize:15},prefix:"\u5468\u540c\u6bd4",suffix:Object($.jsxs)("div",{children:["%",Object($.jsx)(Ne.a,{style:{color:"red",marginLeft:10}})]})}),Object($.jsx)(we.a,{value:10,valueStyle:{fontSize:15},prefix:"\u65e5\u540c\u6bd4",suffix:Object($.jsxs)("div",{children:["%",Object($.jsx)(Ie.a,{style:{color:"#3f8600",marginLeft:10}})]})})]}),Object($.jsx)(Ae,{}),Object($.jsxs)(ke.a,{className:"home-content",title:Object($.jsxs)("div",{className:"home-menu",children:[Object($.jsx)("span",{className:e?"home-menu-active home-menu-visited":"home-menu-visited",onClick:this.handleChange(!0),children:"\u8bbf\u95ee\u91cf"}),Object($.jsx)("span",{className:e?"":"home-menu-active",onClick:this.handleChange(!1),children:"\u9500\u552e\u91cf"})]}),extra:Object($.jsx)(Le,{defaultValue:[Pe()("2019/01/01",Me),Pe()("2019/06/01",Me)],format:Me}),children:[Object($.jsx)(ke.a,{className:"home-table-left",title:e?"\u8bbf\u95ee\u8d8b\u52bf":"\u9500\u552e\u8d8b\u52bf",bodyStyle:{padding:0},extra:Object($.jsx)(Fe.a,{}),children:Object($.jsx)(Re,{})}),Object($.jsx)(ke.a,{title:"\u4efb\u52a1",extra:Object($.jsx)(Fe.a,{}),className:"home-table-right",children:Object($.jsxs)(ve.a,{children:[Object($.jsx)(ve.a.Item,{color:"green",children:"\u65b0\u7248\u672c\u8fed\u4ee3\u4f1a"}),Object($.jsx)(ve.a.Item,{color:"green",children:"\u5b8c\u6210\u7f51\u7ad9\u8bbe\u8ba1\u521d\u7248"}),Object($.jsxs)(ve.a.Item,{color:"red",children:[Object($.jsx)("p",{children:"\u8054\u8c03\u63a5\u53e3"}),Object($.jsx)("p",{children:"\u529f\u80fd\u9a8c\u6536"})]}),Object($.jsxs)(ve.a.Item,{children:[Object($.jsx)("p",{children:"\u767b\u5f55\u529f\u80fd\u8bbe\u8ba1"}),Object($.jsx)("p",{children:"\u6743\u9650\u9a8c\u8bc1"}),Object($.jsx)("p",{children:"\u9875\u9762\u6392\u7248"})]})]})})]})]})}}]),n}(a.Component),De=(n(179),n(104)),Ee=n(91),Ve=n(315),We=(n(168),n(63)),ze=We.a.Option,Ke=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).formRef=r.a.createRef(),e.onFinishFailed=function(e){console.log("Failed:",e)},e}return Object(o.a)(n,[{key:"componentWillMount",value:function(){this.props.setForm(this.formRef)}},{key:"render",value:function(){var e=this.props,t=e.categorys,n=e.parentId;return Object($.jsxs)(j.a,{name:"basic",onFinishFailed:this.onFinishFailed,ref:this.formRef,initialValues:{parentId:n},children:[Object($.jsx)(j.a.Item,{name:"parentId",children:Object($.jsxs)(We.a,{children:[Object($.jsx)(ze,{value:"0",children:"\u4e00\u7ea7\u5206\u7c7b"}),t.map((function(e,t){return Object($.jsx)(ze,{value:e._id,children:e.name},t)}))]})}),Object($.jsx)(j.a.Item,{name:"categoryName",rules:[{required:!0,message:"\u5206\u7c7b\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}],children:Object($.jsx)(b.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"})})]})}}]),n}(a.Component),Be=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={},a.addFormRef=r.a.createRef(),a.onFinishFailed=function(e){console.log("Failed:",e)},e.setForm(a.addFormRef),a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){var e=this.props.categoryName;this.addFormRef.current.setFieldsValue({categoryName:e})}},{key:"render",value:function(){var e=this.props.categoryName;return Object($.jsx)(j.a,{name:"basic",onFinishFailed:this.onFinishFailed,initialValues:{categoryName:e},ref:this.addFormRef,children:Object($.jsx)(j.a.Item,{name:"categoryName",rules:[{required:!0,message:"\u5206\u7c7b\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}],children:Object($.jsx)(b.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"})})})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return!0}}]),n}(a.Component),Je=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={loading:!1,categorys:[],subCategorys:[],parentId:"0",parentName:"",showStatus:0},e.showAdd=function(){e.setState({showStatus:1})},e.showUpdate=function(t){e.category=t,e.setState({showStatus:2})},e.showSubCategorys=function(t){e.setState({parentId:t._id,parentName:t.name},(function(){e.getCategorys()}))},e.showCategorys=function(){e.setState({parentId:"0",parentName:"",subCategorys:[]})},e.handleCancel=function(){e.form.current.resetFields(),e.setState({showStatus:0})},e.getCategorys=function(){var t=Object(x.a)(f.a.mark((function t(n){var a,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),n=n||e.state.parentId,t.next=4,T(n);case 4:a=t.sent,e.setState({loading:!1}),0===a.status&&(r=a.data,"0"===n?e.setState({categorys:r}):e.setState({subCategorys:r}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.initColumns=function(){e.columns=[{title:"\u5206\u7c7b\u7684\u540d\u79f0",dataIndex:"name"},{title:"\u64cd\u4f5c",width:300,render:function(t){return Object($.jsxs)("span",{children:[Object($.jsx)(xe,{onClick:function(){return e.showUpdate(t)},children:"\u4fee\u6539\u5206\u7c7b"}),"0"===e.state.parentId?Object($.jsx)(xe,{onClick:function(){return e.showSubCategorys(t)},children:"\u67e5\u770b\u5b50\u5206\u7c7b"}):null]})}}]},e.addCategory=Object(x.a)(f.a.mark((function t(){var n,a,r,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.form.current,t.prev=1,t.next=4,n.validateFields(["parentId","categoryName"]);case 4:return a=t.sent,e.setState({showStatus:0}),r=a.parentId,c=a.categoryName,n.resetFields(),t.next=10,_(c,r);case 10:0===t.sent.status&&(r===e.state.parentId?e.getCategorys():"0"===r&&e.getCategorys("0")),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),console.log(t.t0);case 17:case"end":return t.stop()}}),t,null,[[1,14]])}))),e.updateCategory=Object(x.a)(f.a.mark((function t(){var n,a,r,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.form.current,t.prev=1,t.next=4,n.validateFields(["categoryName"]);case 4:return a=t.sent,e.setState({showStatus:0}),r=e.category._id,c=a.categoryName,n.resetFields(),t.next=11,A({categoryId:r,categoryName:c});case 11:0===t.sent.status&&e.getCategorys(),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(1),console.log(t.t0);case 18:case"end":return t.stop()}}),t,null,[[1,15]])}))),e}return Object(o.a)(n,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getCategorys()}},{key:"render",value:function(){var e=this,t=this.state,n=t.categorys,a=t.subCategorys,r=t.parentId,c=t.parentName,s=t.loading,i=t.showStatus,o=this.category||{},l="0"===r?"\u4e00\u7ea7\u5206\u7c7b\u5217\u8868":Object($.jsxs)("span",{children:[Object($.jsx)(xe,{onClick:this.showCategorys,children:"\u4e00\u7ea7\u5206\u7c7b\u5217\u8868"}),Object($.jsx)(Ee.a,{style:{marginRight:5}}),Object($.jsx)("span",{children:c})]}),u=Object($.jsxs)(p.a,{type:"primary",onClick:this.showAdd,children:[Object($.jsx)(Ve.a,{}),"\u6dfb\u52a0"]});return Object($.jsxs)(ke.a,{title:l,extra:u,children:[Object($.jsx)(De.a,{bordered:!0,rowKey:"_id",loading:s,dataSource:"0"===r?n:a,columns:this.columns,pagination:{defaultPageSize:5,showQuickJumper:!0}}),Object($.jsx)(me.a,{title:"\u6dfb\u52a0\u5206\u7c7b1",visible:1===i,onOk:this.addCategory,onCancel:this.handleCancel,children:Object($.jsx)(Ke,{categorys:n,parentId:r,setForm:function(t){e.form=t}})}),Object($.jsx)(me.a,{title:"\u66f4\u65b0\u5206\u7c7b",visible:2===i,onOk:this.updateCategory,onCancel:this.handleCancel,children:Object($.jsx)(Be,{categoryName:o.name,setForm:function(t){e.form=t}})})]})}}]),n}(a.Component),qe=(n(468),n(231)),He=n(599),Ye="https://api.chending.top/upload/",Ge=(n(470),qe.b.Item),Qe=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={cName1:"",cName2:""},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=Object(x.a)(f.a.mark((function e(){var t,n,a,r,c,s,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.location.state.product,n=t.pCategoryId,a=t.categoryId,"0"!==n){e.next=9;break}return e.next=4,P(a);case 4:r=e.sent,c=r.data.name,this.setState({cName1:c}),e.next=15;break;case 9:return e.next=11,Promise.all([P(n),P(a)]);case 11:s=e.sent,i=s[0].data.name,o=s[1].data.name,this.setState({cName1:i,cName2:o});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.location.state.product,n=t.name,a=t.desc,r=t.price,c=t.detail,s=t.imgs,i=this.state,o=i.cName1,l=i.cName2,u=Object($.jsxs)("span",{children:[Object($.jsx)(xe,{children:Object($.jsx)(He.a,{style:{marginRight:10,fontSize:20},onClick:function(){return e.props.history.goBack()}})}),Object($.jsx)("span",{children:"\u5546\u54c1\u8be6\u60c5"})]});return Object($.jsx)(ke.a,{title:u,className:"product-detail",children:Object($.jsxs)(qe.b,{children:[Object($.jsxs)(Ge,{children:[Object($.jsx)("span",{className:"left",children:"\u5546\u54c1\u540d\u79f0:"}),Object($.jsx)("span",{children:n})]}),Object($.jsxs)(Ge,{children:[Object($.jsx)("span",{className:"left",children:"\u5546\u54c1\u63cf\u8ff0:"}),Object($.jsx)("span",{children:a})]}),Object($.jsxs)(Ge,{children:[Object($.jsx)("span",{className:"left",children:"\u5546\u54c1\u4ef7\u683c:"}),Object($.jsxs)("span",{children:[r,"\u5143"]})]}),Object($.jsxs)(Ge,{children:[Object($.jsx)("span",{className:"left",children:"\u6240\u5c5e\u5206\u7c7b:"}),Object($.jsxs)("span",{children:[o," ",l?" --\x3e "+l:""]})]}),Object($.jsxs)(Ge,{children:[Object($.jsx)("span",{className:"left",children:"\u5546\u54c1\u56fe\u7247:"}),Object($.jsx)("span",{children:s.map((function(e){return Object($.jsx)("img",{src:Ye+e,className:"product-img",alt:"img"},e)}))})]}),Object($.jsxs)(Ge,{children:[Object($.jsx)("span",{className:"left",children:"\u5546\u54c1\u8be6\u60c5:"}),Object($.jsx)("span",{dangerouslySetInnerHTML:{__html:c}})]})]})})}}]),n}(a.Component),Xe=(n(471),n(311)),Ze=n(152),$e=n(180),et=(n(580),n(310)),tt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;Object(i.a)(this,n),(a=t.call(this,e)).state={previewVisible:!1,previewImage:"",fileList:[],serveURL:"https://api.chending.top"},a.getImgs=function(){return a.state.fileList.map((function(e){return e.name}))},a.handleCancel=function(){return a.setState({previewVisible:!1})},a.handlePreview=function(e){console.log("handlePreview()",e),a.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})},a.handleChange=function(){var e=Object(x.a)(f.a.mark((function e(t){var n,r,c,s,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.file,r=t.fileList,console.log("handleChange()",n.status,r.length,n===r[r.length-1]),"done"!==n.status){e.next=7;break}0===(c=n.response).status?(O.b.success("\u4e0a\u4f20\u56fe\u7247\u6210\u529f!"),s=c.data,i=s.name,o=s.url,(n=r[r.length-1]).name=i,n.url=o):O.b.error("\u4e0a\u4f20\u56fe\u7247\u5931\u8d25"),e.next=12;break;case 7:if("removed"!==n.status){e.next=12;break}return e.next=10,U(n.name);case 10:0===e.sent.status?O.b.success("\u5220\u9664\u56fe\u7247\u6210\u529f!"):O.b.error("\u5220\u9664\u56fe\u7247\u5931\u8d25!");case 12:a.setState({fileList:r});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var r=[],c=a.props.imgs;return c&&c.length>0&&(r=c.map((function(e,t){return{uid:-t,name:e,status:"done",url:Ye+e}}))),a.state={previewVisible:!1,previewImage:"",fileList:r},a}return Object(o.a)(n,[{key:"render",value:function(){var e=this.state,t=e.previewVisible,n=e.previewImage,a=e.fileList,r=Object($.jsxs)("div",{children:[Object($.jsx)(Ve.a,{}),Object($.jsx)("div",{children:"Upload"})]});return Object($.jsxs)("div",{children:[Object($.jsx)(et.a,{action:"https://api.chending.top/manage/img/upload",accept:"image/*",name:"image",listType:"picture-card",fileList:a,onPreview:this.handlePreview,onChange:this.handleChange,children:a.length>=4?null:r}),Object($.jsx)(me.a,{visible:t,footer:null,onCancel:this.handleCancel,children:Object($.jsx)("img",{alt:"example",style:{width:"100%"},src:n})})]})}}]),n}(r.a.Component),nt=n(108),at=n(305),rt=n(306),ct=n.n(rt),st=n(307),it=n.n(st),ot=(n(569),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;Object(i.a)(this,n),(a=t.call(this,e)).state={editorState:nt.EditorState.createEmpty()},a.onEditorStateChange=function(e){a.setState({editorState:e})},a.getDetail=function(){return ct()(Object(nt.convertToRaw)(a.state.editorState.getCurrentContent()))},a.uploadImageCallBack=function(e){return new Promise((function(t,n){var a=new XMLHttpRequest;a.open("POST","/manage/img/upload");var r=new FormData;r.append("image",e),a.send(r),a.addEventListener("load",(function(){var e=JSON.parse(a.responseText).data.url;t({data:{link:e}})})),a.addEventListener("error",(function(){var e=JSON.parse(a.responseText);n(e)}))}))};var r=a.props.detail;if(r){var c=it()(r),s=nt.ContentState.createFromBlockArray(c.contentBlocks),o=nt.EditorState.createWithContent(s);a.state={editorState:o}}else a.state={editorState:nt.EditorState.createEmpty()};return a}return Object(o.a)(n,[{key:"render",value:function(){var e=this.state.editorState;return Object($.jsx)(at.Editor,{editorState:e,editorStyle:{border:"1px solid black",minHeight:200,paddingLeft:10},onEditorStateChange:this.onEditorStateChange,toolbar:{image:{uploadCallback:this.uploadImageCallBack,alt:{present:!0,mandatory:!0}}}})}}]),n}(a.Component)),lt=j.a.Item,ut=b.a.TextArea,dt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={options:[]},a.formRef=r.a.createRef(),a.initOptions=function(){var e=Object(x.a)(f.a.mark((function e(t){var n,r,c,s,i,o,l;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.map((function(e){return{value:e._id,label:e.name,isLeaf:!1}})),r=Object($e.a)(a),c=r.isUpdate,s=r.product,i=s.pCategoryId,!c||"0"===i){e.next=10;break}return e.next=6,a.getCategorys(i);case 6:o=e.sent,l=o.map((function(e){return{value:e._id,label:e.name,isLeaf:!0}})),n.find((function(e){return e.value===i})).children=l;case 10:a.setState({options:n});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getCategorys=function(){var e=Object(x.a)(f.a.mark((function e(t){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(t);case 2:if(0!==(n=e.sent).status){e.next=10;break}if(r=n.data,"0"!==t){e.next=9;break}a.initOptions(r),e.next=10;break;case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.loadData=function(){var e=Object(x.a)(f.a.mark((function e(t){var n,r,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t[0]).loading=!0,e.next=4,a.getCategorys(n.value);case 4:r=e.sent,n.loading=!1,r&&r.length>0?(c=r.map((function(e){return{value:e._id,label:e.name,isLeaf:!0}})),n.children=c):n.isLeaf=!0,a.setState({options:Object(Ze.a)(a.state.options)});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.submit=function(){a.props.form.validateFields(function(){var e=Object(x.a)(f.a.mark((function e(t,n){var r,c,s,i,o,l,u,d,h;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=11;break}return r=n.name,c=n.desc,s=n.price,1===(i=n.categoryIds).length?(o="0",l=i[0]):(o=i[0],l=i[1]),u=a.pw.current.getImgs(),d=a.editor.current.getDetail(),h={name:r,desc:c,price:s,imgs:u,detail:d,pCategoryId:o,categoryId:l},a.isUpdate&&(h._id=a.product._id),e.next=9,D(h);case 9:0===e.sent.status?(O.b.success("".concat(a.isUpdate?"\u66f4\u65b0":"\u6dfb\u52a0","\u5546\u54c1\u6210\u529f!")),a.props.history.goBack()):O.b.error("".concat(a.isUpdate?"\u66f4\u65b0":"\u6dfb\u52a0","\u5546\u54c1\u5931\u8d25!"));case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},a.validatePrice=function(e,t,n){1*t>0?n():n("\u4ef7\u683c\u5fc5\u987b\u5927\u4e8e0")},a.onFinish=function(){var e=Object(x.a)(f.a.mark((function e(t){var n,r,c,s,i,o,l,u,d;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,r=t.desc,c=t.price,1===(s=t.categoryIds).length?(i="0",o=s[0]):(i=s[0],o=s[1]),l=a.pw.current.getImgs(),u=a.editor.current.getDetail(),d={name:n,desc:r,price:c,imgs:l,detail:u,pCategoryId:i,categoryId:o},a.isUpdate&&(d._id=a.product._id),e.next=8,D(d);case 8:0===e.sent.status?(O.b.success("".concat(a.isUpdate?"\u66f4\u65b0":"\u6dfb\u52a0","\u5546\u54c1\u6210\u529f!")),a.props.history.goBack()):O.b.error("".concat(a.isUpdate?"\u66f4\u65b0":"\u6dfb\u52a0","\u5546\u54c1\u5931\u8d25!"));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.onFinishFailed=function(e){console.log("Failed:",e)},a.pw=r.a.createRef(),a.editor=r.a.createRef(),a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.getCategorys("0")}},{key:"componentWillMount",value:function(){var e=this.props.location.state;this.isUpdate=!!e,this.product=e||{}}},{key:"render",value:function(){var e=this,t=this.isUpdate,n=this.product,a=n.pCategoryId,r=n.categoryId,c=n.imgs,s=n.detail,i=[];t&&("0"===a||i.push(a),i.push(r));var o=Object($.jsxs)("span",{children:[Object($.jsx)(xe,{onClick:function(){return e.props.history.goBack()},children:Object($.jsx)(He.a,{style:{fontSize:20}})}),Object($.jsx)("span",{children:t?"\u4fee\u6539\u5546\u54c1":"\u6dfb\u52a0\u5546\u54c1"})]});return Object($.jsx)(ke.a,{title:o,children:Object($.jsxs)(j.a,Object(Oe.a)(Object(Oe.a)({},{labelCol:{span:2},wrapperCol:{span:8}}),{},{ref:this.formRef,onFinish:this.onFinish,onFinishFailed:this.onFinishFailed,initialValues:n,children:[Object($.jsx)(lt,{name:"name",label:"\u5546\u54c1\u540d\u79f0",rules:[{required:!0,message:"\u5fc5\u987b\u8f93\u5165\u5546\u54c1\u540d\u79f0"}],children:Object($.jsx)(b.a,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"})}),Object($.jsx)(lt,{name:"desc",label:"\u5546\u54c1\u63cf\u8ff0",rules:[{required:!0,message:"\u5fc5\u987b\u8f93\u5165\u5546\u54c1\u63cf\u8ff0"}],children:Object($.jsx)(ut,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u63cf\u8ff0",autosize:{minRows:2,maxRows:6}})}),Object($.jsx)(lt,{name:"price",label:"\u5546\u54c1\u4ef7\u683c",rules:[{required:!0,message:"\u5fc5\u987b\u8f93\u5165\u5546\u54c1\u540d\u79f0"},{validator:this.validatePrice}],children:Object($.jsx)(b.a,{type:"number",placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u4ef7\u683c",addonAfter:"\u5143"})}),Object($.jsx)(lt,{name:"categoryIds",label:"\u5546\u54c1\u5206\u7c7b",initialValue:i,rules:[{required:!0,message:"\u5fc5\u987b\u6307\u5b9a\u5546\u54c1\u5206\u7c7b"}],children:Object($.jsx)(Xe.a,{placeholder:"\u8bf7\u6307\u5b9a\u5546\u54c1\u5206\u7c7b",options:this.state.options,loadData:this.loadData})}),Object($.jsx)(lt,{label:"\u5546\u54c1\u56fe\u7247",children:Object($.jsx)(tt,{ref:this.pw,imgs:c})}),Object($.jsx)(lt,{label:"\u5546\u54c1\u8be6\u60c5",labelCol:{span:2},wrapperCol:{span:20},children:Object($.jsx)(ot,{ref:this.editor,detail:s})}),Object($.jsx)(lt,{children:Object($.jsx)(p.a,{type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"})})]}))})}}]),n}(a.PureComponent),ht=We.a.Option,pt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={total:0,products:[],loading:!1,searchName:"",searchType:"productName"},e.initColumns=function(){e.columns=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name"},{title:"\u5546\u54c1\u63cf\u8ff0",dataIndex:"desc"},{title:"\u4ef7\u683c",dataIndex:"price",render:function(e){return"\xa5"+e}},{width:100,title:"\u72b6\u6001",render:function(t){var n=t.status,a=t._id,r=1===n?2:1;return Object($.jsxs)("span",{children:[Object($.jsx)(p.a,{type:"primary",onClick:function(){return e.updateStatus(a,r)},children:1===n?"\u4e0b\u67b6":"\u4e0a\u67b6"}),Object($.jsx)("span",{children:1===n?"\u5728\u552e":"\u5df2\u4e0b\u67b6"})]})}},{width:100,title:"\u64cd\u4f5c",render:function(t){return Object($.jsxs)("span",{children:[Object($.jsx)(xe,{onClick:function(){return e.props.history.push("/product/detail",{product:t})},children:"\u8be6\u60c5"}),Object($.jsx)(xe,{onClick:function(){return e.props.history.push("/product/addOrUpdate",t)},children:"\u4fee\u6539"})]})}}]},e.getProducts=function(){var t=Object(x.a)(f.a.mark((function t(n){var a,r,c,s,i,o,l;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.pageNum=n,e.setState({loading:!0}),a=e.state,r=a.searchName,c=a.searchType,!r){t.next=9;break}return t.next=6,M({pageNum:n,pageSize:3,searchName:r,searchType:c});case 6:s=t.sent,t.next=12;break;case 9:return t.next=11,R(n,3);case 11:s=t.sent;case 12:e.setState({loading:!1}),0===s.status&&(i=s.data,o=i.total,l=i.list,e.setState({total:o,products:l}));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.updateStatus=function(){var t=Object(x.a)(f.a.mark((function t(n,a){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L(n,a);case 2:0===t.sent.status&&(O.b.success("\u66f4\u65b0\u5546\u54c1\u6210\u529f"),e.getProducts(e.pageNum));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(o.a)(n,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getProducts(1)}},{key:"render",value:function(){var e=this,t=this.state,n=t.products,a=t.total,r=t.loading,c=t.searchType,s=t.searchName,i=Object($.jsxs)("span",{children:[Object($.jsxs)(We.a,{value:c,style:{width:150},onChange:function(t){return e.setState({searchType:t})},children:[Object($.jsx)(ht,{value:"productName",children:"\u6309\u540d\u79f0\u641c\u7d22"}),Object($.jsx)(ht,{value:"productDesc",children:"\u6309\u63cf\u8ff0\u641c\u7d22"})]}),Object($.jsx)(b.a,{placeholder:"\u5173\u952e\u5b57",style:{width:150,margin:"0 15px"},value:s,onChange:function(t){return e.setState({searchName:t.target.value})}}),Object($.jsx)(p.a,{type:"primary",onClick:function(){return e.getProducts(1)},children:"\u641c\u7d22"})]}),o=Object($.jsxs)(p.a,{type:"primary",onClick:function(){return e.props.history.push("/product/addOrUpdate")},children:[Object($.jsx)(Ve.a,{}),"\u6dfb\u52a0\u5546\u54c1"]});return Object($.jsx)(ke.a,{title:i,extra:o,children:Object($.jsx)(De.a,{bordered:!0,rowKey:"_id",loading:r,dataSource:n,columns:this.columns,pagination:{current:this.pageNum,total:a,defaultPageSize:3,showQuickJumper:!0,onChange:this.getProducts}})})}}]),n}(a.Component),jt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object($.jsx)("div",{children:Object($.jsxs)(h.d,{children:[Object($.jsx)(h.b,{path:"/product",exact:!0,component:pt}),Object($.jsx)(h.b,{path:"/product/addOrUpdate",component:dt}),Object($.jsx)(h.b,{path:"/product/detail",component:Qe}),Object($.jsx)(h.a,{to:"/product"})]})})}}]),n}(a.Component),bt=j.a.Item,mt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).addForm=r.a.createRef(),e}return Object(o.a)(n,[{key:"componentWillMount",value:function(){this.props.setForm(this.addForm)}},{key:"render",value:function(){return Object($.jsx)(j.a,{ref:this.addForm,children:Object($.jsx)(bt,Object(Oe.a)(Object(Oe.a)({name:"roleName",label:"\u89d2\u8272\u540d\u79f0"},{labelCol:{span:4},wrapperCol:{span:15}}),{},{children:Object($.jsx)(b.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0"})}))})}}]),n}(a.Component),ft=(n(570),n(230)),Ot=[{title:"\u5e73\u53f0\u6743\u9650",key:"/all",children:he}],xt=j.a.Item,gt=ft.a.TreeNode,yt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;Object(i.a)(this,n),(a=t.call(this,e)).getMenus=function(){return a.state.checkedKeys},a.getTreeNodes=function(e){return e.reduce((function(e,t){return e.push(Object($.jsx)(gt,{title:t.title,children:t.children?a.getTreeNodes(t.children):null},t.key)),e}),[])},a.getTreeData=function(e){return e.reduce((function(e,t){return e.push({title:t.title,key:t.key,children:t.children?a.getTreeData(t.children):null}),console.log("pre",e),e}),[])},a.onCheck=function(e){console.log("onCheck",e),a.setState({checkedKeys:e})};var r=a.props.role.menus;return a.state={checkedKeys:r},a}return Object(o.a)(n,[{key:"componentWillMount",value:function(){this.treeData=this.getTreeData(Ot)}},{key:"componentWillReceiveProps",value:function(e){console.log("componentWillReceiveProps()",e);var t=e.role.menus;this.setState({checkedKeys:t})}},{key:"render",value:function(){console.log("AuthForm render()");var e=this.props.role,t=this.state.checkedKeys;return Object($.jsxs)("div",{children:[Object($.jsx)(xt,Object(Oe.a)(Object(Oe.a)({label:"\u89d2\u8272\u540d\u79f0"},{labelCol:{span:4},wrapperCol:{span:15}}),{},{children:Object($.jsx)(b.a,{value:e.name,disabled:!0})})),Object($.jsx)(ft.a,{checkable:!0,defaultExpandAll:!0,checkedKeys:t,onCheck:this.onCheck,treeData:this.treeData})]})}}]),n}(a.PureComponent),vt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={roles:[],role:{},isShowAdd:!1,isShowAuth:!1},a.initColumn=function(){a.columns=[{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",render:function(e){return fe(e)}},{title:"\u6388\u6743\u65f6\u95f4",dataIndex:"auth_time",render:fe},{title:"\u6388\u6743\u4eba",dataIndex:"auth_name"}]},a.getRoles=Object(x.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(I+"/manage/role/list");case 2:0===(t=e.sent).status&&(n=t.data,a.setState({roles:n}));case 4:case"end":return e.stop()}}),e)}))),a.onRow=function(e){return{onClick:function(t){console.log("row onClick()",e),a.setState({role:e})}}},a.addRole=function(){var e=a.form.current,t=e.validateFields,n=e.resetFields;t().then(function(){var e=Object(x.a)(f.a.mark((function e(t){var r,c,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({isShowAdd:!1}),r=t.roleName,n(),e.next=5,E(r);case 5:0===(c=e.sent).status?(O.b.success("\u6dfb\u52a0\u89d2\u8272\u6210\u529f"),s=c.data,a.setState((function(e){return{roles:[].concat(Object(Ze.a)(e.roles),[s])}}))):O.b.success("\u6dfb\u52a0\u89d2\u8272\u5931\u8d25");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("err",e)}))},a.updateRole=Object(x.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({isShowAuth:!1}),t=a.state.role,n=a.auth.current.getMenus(),t.menus=n,t.auth_time=Date.now(),t.auth_name=J.user.username,e.next=8,V(t);case 8:0===e.sent.status&&(t._id===J.user.role_id?(J.user={},X(),a.props.history.replace("/login"),O.b.success("\u5f53\u524d\u7528\u6237\u89d2\u8272\u6743\u9650\u6210\u529f")):(O.b.success("\u8bbe\u7f6e\u89d2\u8272\u6743\u9650\u6210\u529f"),a.setState({roles:Object(Ze.a)(a.state.roles)})));case 10:case"end":return e.stop()}}),e)}))),a.auth=r.a.createRef(),a}return Object(o.a)(n,[{key:"componentWillMount",value:function(){this.initColumn()}},{key:"componentDidMount",value:function(){this.getRoles()}},{key:"render",value:function(){var e=this,t=this.state,n=t.roles,a=t.role,r=t.isShowAdd,c=t.isShowAuth,s=Object($.jsxs)("span",{children:[Object($.jsx)(p.a,{type:"primary",onClick:function(){return e.setState({isShowAdd:!0})},children:"\u521b\u5efa\u89d2\u8272"}),"\xa0\xa0",Object($.jsx)(p.a,{type:"primary",disabled:!a._id,onClick:function(){return e.setState({isShowAuth:!0})},children:"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650"})]});return Object($.jsxs)(ke.a,{title:s,children:[Object($.jsx)(De.a,{bordered:!0,rowKey:"_id",dataSource:n,columns:this.columns,pagination:{defaultPageSize:3},rowSelection:{type:"radio",selectedRowKeys:[a._id],onSelect:function(t){e.setState({role:t})}},onRow:this.onRow}),Object($.jsx)(me.a,{title:"\u6dfb\u52a0\u89d2\u8272",visible:r,onOk:this.addRole,onCancel:function(){e.setState({isShowAdd:!1}),e.form.current.resetFields()},children:Object($.jsx)(mt,{setForm:function(t){return e.form=t}})}),Object($.jsx)(me.a,{title:"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650",visible:c,onOk:this.updateRole,onCancel:function(){e.setState({isShowAuth:!1})},children:Object($.jsx)(yt,{ref:this.auth,role:a})})]})}}]),n}(a.Component),kt=j.a.Item,wt=We.a.Option,Ct=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).form=r.a.createRef(),e}return Object(o.a)(n,[{key:"componentWillMount",value:function(){this.props.setForm(this.form)}},{key:"render",value:function(){var e=this.props,t=e.roles,n=e.user;return Object($.jsxs)(j.a,Object(Oe.a)(Object(Oe.a)({},{labelCol:{span:4},wrapperCol:{span:15}}),{},{ref:this.form,initialValues:n,children:[Object($.jsx)(kt,{name:"username",label:"\u7528\u6237\u540d",children:Object($.jsx)(b.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"})}),n._id?null:Object($.jsx)(kt,{name:"password",label:"\u5bc6\u7801",children:Object($.jsx)(b.a,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"})}),Object($.jsx)(kt,{name:"phone",label:"\u624b\u673a\u53f7",children:Object($.jsx)(b.a,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7"})}),Object($.jsx)(kt,{name:"email",label:"\u90ae\u7bb1",children:Object($.jsx)(b.a,{placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1"})}),Object($.jsx)(kt,{name:"role_id",label:"\u89d2\u8272",children:Object($.jsx)(We.a,{children:t.map((function(e){return Object($.jsx)(wt,{value:e._id,children:e.name},e._id)}))})})]}))}}]),n}(a.PureComponent),St=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={users:[],roles:[],isShow:!1},e.initColumns=function(){e.columns=[{title:"\u7528\u6237\u540d",dataIndex:"username"},{title:"\u90ae\u7bb1",dataIndex:"email"},{title:"\u7535\u8bdd",dataIndex:"phone"},{title:"\u6ce8\u518c\u65f6\u95f4",dataIndex:"create_time",render:fe},{title:"\u6240\u5c5e\u89d2\u8272",dataIndex:"role_id",render:function(t){return e.roleNames[t]}},{title:"\u64cd\u4f5c",render:function(t){return Object($.jsxs)("span",{children:[Object($.jsx)(xe,{onClick:function(){return e.showUpdate(t)},children:"\u4fee\u6539"}),Object($.jsx)(xe,{onClick:function(){return e.deleteUser(t)},children:"\u5220\u9664"})]})}}]},e.initRoleNames=function(t){var n=t.reduce((function(e,t){return e[t._id]=t.name,e}),{});e.roleNames=n},e.showAdd=function(){e.user=null,e.setState({isShow:!0})},e.showUpdate=function(t){e.user=t,e.setState({isShow:!0})},e.deleteUser=function(t){me.a.confirm({title:"\u786e\u8ba4\u5220\u9664".concat(t.username,"\u5417?"),onOk:function(){var n=Object(x.a)(f.a.mark((function n(){return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,z(t._id);case 2:0===n.sent.status&&(O.b.success("\u5220\u9664\u7528\u6237\u6210\u529f!"),e.getUsers());case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()})},e.addOrUpdateUser=Object(x.a)(f.a.mark((function t(){var n,a,r,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({isShow:!1}),n=e.form.current,a=n.getFieldsValue,r=n.resetFields,c=a(),r(),e.user&&(c._id=e.user._id),t.next=7,K(c);case 7:0===t.sent.status&&(O.b.success("".concat(e.user?"\u4fee\u6539":"\u6dfb\u52a0","\u7528\u6237\u6210\u529f")),e.getUsers());case 9:case"end":return t.stop()}}),t)}))),e.getUsers=Object(x.a)(f.a.mark((function t(){var n,a,r,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,W();case 2:0===(n=t.sent).status&&(a=n.data,r=a.users,c=a.roles,e.initRoleNames(c),e.setState({users:r,roles:c}));case 4:case"end":return t.stop()}}),t)}))),e}return Object(o.a)(n,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getUsers()}},{key:"render",value:function(){var e=this,t=this.state,n=t.users,a=t.roles,r=t.isShow,c=this.user||{},s=Object($.jsx)(p.a,{type:"primary",onClick:this.showAdd,children:"\u521b\u5efa\u7528\u6237"});return Object($.jsxs)(ke.a,{title:s,children:[Object($.jsx)(De.a,{bordered:!0,rowKey:"_id",dataSource:n,columns:this.columns,pagination:{defaultPageSize:2}}),Object($.jsx)(me.a,{title:c._id?"\u4fee\u6539\u7528\u6237":"\u6dfb\u52a0\u7528\u6237",visible:r,onOk:this.addOrUpdateUser,onCancel:function(){e.form.current.resetFields(),e.setState({isShow:!1})},children:Object($.jsx)(Ct,{setForm:function(t){return e.form=t},roles:a,user:c})})]})}}]),n}(a.Component),Nt=n(118),It=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={sales:[5,20,36,10,10,20],stores:[6,10,25,20,15,10]},e.update=function(){e.setState((function(e){return{sales:e.sales.map((function(e){return e+1})),stores:e.stores.reduce((function(e,t){return e.push(t-1),e}),[])}}))},e.getOption=function(e,t){return{title:{text:"ECharts \u5165\u95e8\u793a\u4f8b"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u886b","\u96ea\u7eba\u886b","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"bar",data:e},{name:"\u5e93\u5b58",type:"bar",data:t}]}},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this.state,t=e.sales,n=e.stores;return Object($.jsxs)("div",{children:[Object($.jsx)(ke.a,{children:Object($.jsx)(p.a,{type:"primary",onClick:this.update,children:"\u66f4\u65b0"})}),Object($.jsx)(ke.a,{title:"\u67f1\u72b6\u56fe\u4e00",children:Object($.jsx)(Nt.a,{option:this.getOption(t,n)})})]})}}]),n}(a.Component),Ft=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={sales:[5,20,36,10,10,20],stores:[6,10,25,20,15,10]},e.update=function(){e.setState((function(e){return{sales:e.sales.map((function(e){return e+1})),stores:e.stores.reduce((function(e,t){return e.push(t-1),e}),[])}}))},e.getOption=function(e,t){return{title:{text:"ECharts \u5165\u95e8\u793a\u4f8b"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u886b","\u96ea\u7eba\u886b","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"line",data:e},{name:"\u5e93\u5b58",type:"line",data:t}]}},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this.state,t=e.sales,n=e.stores;return Object($.jsxs)("div",{children:[Object($.jsx)(ke.a,{children:Object($.jsx)(p.a,{type:"primary",onClick:this.update,children:"\u66f4\u65b0"})}),Object($.jsx)(ke.a,{title:"\u6298\u7ebf\u56fe\u4e00",children:Object($.jsx)(Nt.a,{option:this.getOption(t,n)})})]})}}]),n}(a.Component),Tt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).getOption=function(){return{title:{text:"\u67d0\u7ad9\u70b9\u7528\u6237\u8bbf\u95ee\u6765\u6e90",subtext:"\u7eaf\u5c5e\u865a\u6784",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:["\u76f4\u63a5\u8bbf\u95ee","\u90ae\u4ef6\u8425\u9500","\u8054\u76df\u5e7f\u544a","\u89c6\u9891\u5e7f\u544a","\u641c\u7d22\u5f15\u64ce"]},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:335,name:"\u76f4\u63a5\u8bbf\u95ee"},{value:310,name:"\u90ae\u4ef6\u8425\u9500"},{value:234,name:"\u8054\u76df\u5e7f\u544a"},{value:135,name:"\u89c6\u9891\u5e7f\u544a"},{value:1548,name:"\u641c\u7d22\u5f15\u64ce"}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}},e.getOption2=function(){return{backgroundColor:"#2c343c",title:{text:"Customized Pie",left:"center",top:20,textStyle:{color:"#ccc"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},visualMap:{show:!1,min:80,max:600,inRange:{colorLightness:[0,1]}},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",center:["50%","50%"],data:[{value:335,name:"\u76f4\u63a5\u8bbf\u95ee"},{value:310,name:"\u90ae\u4ef6\u8425\u9500"},{value:274,name:"\u8054\u76df\u5e7f\u544a"},{value:235,name:"\u89c6\u9891\u5e7f\u544a"},{value:400,name:"\u641c\u7d22\u5f15\u64ce"}].sort((function(e,t){return e.value-t.value})),roseType:"radius",label:{normal:{textStyle:{color:"rgba(255, 255, 255, 0.3)"}}},labelLine:{normal:{lineStyle:{color:"rgba(255, 255, 255, 0.3)"},smooth:.2,length:10,length2:20}},itemStyle:{normal:{color:"#c23531",shadowBlur:200,shadowColor:"rgba(0, 0, 0, 0.5)"}},animationType:"scale",animationEasing:"elasticOut",animationDelay:function(e){return 200*Math.random()}}]}},e}return Object(o.a)(n,[{key:"render",value:function(){return Object($.jsxs)("div",{children:[Object($.jsx)(ke.a,{title:"\u997c\u56fe\u4e00",children:Object($.jsx)(Nt.a,{option:this.getOption(),style:{height:300}})}),Object($.jsx)(ke.a,{title:"\u997c\u56fe\u4e8c",children:Object($.jsx)(Nt.a,{option:this.getOption2(),style:{height:300}})})]})}}]),n}(a.Component),Pt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object($.jsx)("div",{children:"NotFound"})}}]),n}(a.Component),_t=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object($.jsx)("div",{children:"Order"})}}]),n}(a.Component),At=te.a.Footer,Rt=te.a.Sider,Mt=te.a.Content,Lt=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=J.user;return e&&e._id?Object($.jsxs)(te.a,{style:{minHeight:"100%"},children:[Object($.jsx)(Rt,{children:Object($.jsx)(be,{})}),Object($.jsxs)(te.a,{children:[Object($.jsx)(ye,{children:"Header"}),Object($.jsx)(Mt,{style:{margin:20,background:"#fff"},children:Object($.jsxs)(h.d,{children:[Object($.jsx)(h.a,{from:"/",exact:!0,to:"/home"}),Object($.jsx)(h.b,{path:"/home",component:Ue}),Object($.jsx)(h.b,{path:"/category",component:Je}),Object($.jsx)(h.b,{path:"/product",component:jt}),Object($.jsx)(h.b,{path:"/user",component:St}),Object($.jsx)(h.b,{path:"/role",component:vt}),Object($.jsx)(h.b,{path:"/charts/bar",component:It}),Object($.jsx)(h.b,{path:"/charts/pie",component:Tt}),Object($.jsx)(h.b,{path:"/charts/line",component:Ft}),Object($.jsx)(h.b,{path:"/order",component:_t}),Object($.jsx)(h.b,{component:Pt})]})}),Object($.jsx)(At,{style:{textAlign:"center",color:"#cccccc"},children:"Footer"})]})]}):Object($.jsx)(h.a,{to:"/login"})}}]),n}(a.Component),Ut=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object($.jsx)(d.a,{children:Object($.jsxs)(h.d,{children:[Object($.jsx)(h.b,{path:"/login",component:ee}),Object($.jsx)(h.b,{path:"/",component:Lt})]})})}}]),n}(a.Component),Dt=Q();J.user=Dt,s.a.render(Object($.jsx)(Ut,{}),document.getElementById("root"))}},[[577,1,2]]]);
//# sourceMappingURL=main.35dca9dd.chunk.js.map